launch:
    parameters: 
         appPrefix:
             description: Web application prefix
             default: myApp
         accessKey:
             description: AWS Access Key
         secretKey:
             description: AWS Secret Key

    steps:
        - provision:
            action: provisionAmazonVm
            parameters:
                 roleName: web
                 jcloudsIdentity: $accessKey
                 jcloudsCredential: $secretKey
                 ec2SecurityGroup: wlc
            output:
                 publicIp: ips
        - install-java:
            action: install
            parameters:
                roles: [web]
                runList: ["recipe[java]"]
        - download:
            action: gitClone
            parameters:
                roles: [web]
                url: https://github.com/erkfel/wlp.git
                targetDirectory: ~/wlp
#        - install-wlc:
#            action: execrun
#            description: Sample command for cloning git repos
#            parameters:
#                phase: "install"
#                precedingPhases: ["exec"]
#                roles: [web]
#                command:
#                     - ~/wlp/install.sh

    return:
        - appUrl:
            description: Url to the application
            value: http://${publicIp}:9080

destroy:
  steps:
    - undeployEnv:
        action: "undeployEnv"
        parameters:
          phase: "destroy"